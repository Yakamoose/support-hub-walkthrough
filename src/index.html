<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Support Hub Walkthrough</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

  <style>
    @font-face {
      font-display: swap;
      font-family: "visa-font";
      src: url('./assets/fonts/VisaDialect-Regular.ttf') format('truetype');
      /* src: url("https://cdn.visa.com/v2/assets/fonts/types/OpenSans-Light.woff"); */
    }

    @font-face {
      font-display: swap;
      font-family: "visa-font-semi-bold";
      src: url('./assets/fonts/VisaDialect-Semibold.ttf') format('truetype');
      /* src: url("https://cdn.visa.com/v2/assets/fonts/types/OpenSans-SemiBold.woff"); */
    }

    @font-face {
      font-display: swap;
      font-family: 'visa-bold';
      src: url('./assets/fonts/VisaDialect-Bold.ttf') format('truetype');
      /* src: url("https://cdn.visa.com/v2/assets/fonts/types/OpenSans-Bold.woff");
     ???Not sure about this link */
    }

    @font-face {
      font-family: 'visa-med';
      src: url('./assets/fonts/VisaDialect-Medium.ttf') format('truetype');
    }


    :root {
      --brand-primary-color: #1434CB;
      --brand-primary-light-color: #3B57DE;
      --brand-primary-dark-color: #021E4C;
      --brand-secondary-color: #FCC015;
      --brand-secondary-light-color: #FFD700;
      --brand-secondary-dark-color: #F7B600;
      --brand-tertiary-7-color: #2C2C2C;
      --brand-tertiary-6-color: #5C5C5C;
      --brand-tertiary-5-color: #979797;
      --brand-tertiary-4-color: #B9B9B9;
      --brand-tertiary-3-color: #DEDEDE;
      --brand-tertiary-2-color: #EEEEEE;
      --brand-tertiary-1-color: #F7F7F7;
      --brand-white-color: white;
      --brand-alert: #D50000;
      --visa-green: #40996B;
      --visa-light-blue: #2B94F5;
      --visa-rouge-red: #D65168;
      --visa-sorbet: #FFEF99;
      --blue-border-width: 4px;
    }

    * {
      font-family: 'visa-font', sans-serif, Tahoma;
    }

    body {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: var(--brand-tertiary-1-color);
    }

    .vs-loading-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(128, 128, 128, 1);
      z-index: 999;
    }

    .walkthrough-container {
      height: 100vh;
      width: 100%;
      /* min-width: 1500px; */
      overflow: auto;
      position: relative;
      padding: 40px;
      display: flex;
      background-color: var(--brand-tertiary-1-color);
    }

    .graphic-container {
      min-width: calc(100vh * (935/675) - 116px);
      height: 100%;
      margin-right: 20px;
      background-color: var(--brand-primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .graphic-container img {
      width: 101%;
      height: 101%;
    }

    .details-container {
      flex-grow: 1;
      height: 100%;
      /* min-width: 500px; */
    }

    .details-header {
      display: flex;
      align-items: center;
      margin: 5px 10px 20px;
    }

    .details-header div:first-of-type {
      margin-right: auto;
      /* font-size: 14px; */
      padding-right: 2rem;
    }

    .details-header .visa-logo img {
      height: 50px;
      width: auto;
    }

    /* .details-header .visa-logo p {
      margin: 5px 0 0 6px;
    } */

    .details-header .return-vol {
      /* display: flex; */
      display: none;
      align-items: center;
    }

    .details-header .return-vol p {
      font-size: 13px;
      line-height: 1.2;
      color: var(--brand-primary-color);
      margin: 0;
      font-family: 'visa-font-semi-bold', sans-serif;
      text-wrap: nowrap;
    }

    .details-header .return-vol img {
      height: 32px;
      width: auto;
    }

    .hamburger img {
      height: 40px;
      width: auto;
    }

    .details-body {
      height: calc(100% - 54px - 25px);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background-color: #fff;
    }

    .details-body .details-cont {
      overflow: auto;
    }

    .details-body hr {
      border-color: var(--brand-primary-color);
      border-width: var(--blue-border-width);
      opacity: 1;
    }

    .wt-details {
      padding: 32px 35px 10px;
    }

    .wt-details .wt-category {
      font-family: 'visa-font-semi-bold', sans-serif;
      font-size: 1rem;
      margin-bottom: .5rem;
    }

    .wt-details .wt-title {
      font-family: 'visa-font-semi-bold', sans-serif;
      font-size: 39px;
      color: var(--brand-primary-color);
      margin-bottom: 0;
      line-height: 1.1;
      letter-spacing: -.5px;
      /* margin-top: 10px; */
    }

    .step-description {
      padding: 10px 35px 10px;
      font-size: 20px;
      font-family: 'visa-font', sans-serif;
      line-height: 1.4;
    }

    .step-description b {
      font-family: 'visa-font-semi-bold', sans-serif;
    }

    .step-description img {
      vertical-align: initial !important;
      width: 18px;
      height: auto;
    }

    .step-description p:first-of-type {
      margin-bottom: 2rem;
      font-size: 1.3rem;
      line-height: 1.2;
    }

    .step-description .note {
      background-color: rgba(199, 237, 255, .4);
      border-radius: 20px;
      font-size: 1.1rem;
      line-height: 1.5;
      padding: 15px 21px;
      /* margin-top: 2rem; */
    }

    .step-description br {
      content: "";
      display: block;
      margin-top: 1rem;
    }

    .step-description .start-btn,
    .step-description .next-btn {
      margin-top: 2rem;
      width: fit-content;
    }

    .details-footer {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      font-size: 30px;
      font-family: 'visa-font', sans-serif;
      font-weight: 100;
      color: var(--brand-primary-color);
      padding: 0 22px 23px 34px;
    }

    .details-footer img {
      height: 40px;
      width: auto;
    }

    .details-footer .double-carat img {
      height: 30px;
      /* margin-left: 10px; */
    }

    .details-footer .btn:disabled {
      border: none !important;
    }

    #next-tutorial {
      margin-left: 10px;
    }

    .blue-border {
      border-radius: 20px;
      border: var(--blue-border-width) solid var(--brand-primary-color);
      overflow: hidden;
    }

    .img-container.blue-border:hover,
    .gs-img-container.blue-border:hover {
      border: var(--blue-border-width) solid transparent;
      /* border: none; */
    }
















    .nav-modal-cont {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(128, 128, 128, 1);
      padding: 40px;
      z-index: 1000;
      display: none;
    }

    .nav-modal-cont .nav-modal {
      background-color: #fff;
      /* border-radius: 20px; */
      overflow: hidden;
    }

    .nav-modal-cont .nav-modal .nav-menu {
      border-radius: 20px 0 0 20px;
      display: flex;
      flex-direction: column;
      border-right: var(--blue-border-width) solid var(--brand-primary-color);
      padding: 0;
      /* overflow: auto; */

      flex: 0 0 auto;
      width: 20%;
    }

    .nav-modal-cont .nav-modal .nav-menu .nav-header {
      padding: 2.5rem 10% 1.5rem;
      width: 100%;
    }

    .nav-header img {
      width: 95%;
      max-width: 300px;
      height: auto;
      margin-bottom: 8px;
    }

    .nav-menu .nav-links {
      padding: 0 1rem;
      margin: 0;
      overflow: hidden auto;

    }

    .nav-menu .nav-links li {
      border-radius: 10px !important;
      list-style: none;
      padding: 25px 20px;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
    }

    .nav-menu .nav-links li.active {
      background-color: var(--brand-primary-color) !important;
    }

    .nav-menu .nav-links li:hover {
      background-color: rgba(199, 237, 255, .4);
      cursor: pointer;
    }

    .nav-menu .nav-links li:hover a {
      color: var(--brand-primary-color) !important;
    }

    .nav-menu .nav-links li.active a {
      color: #fff !important;
    }

    .nav-menu .nav-links li a {
      font-size: 17px;
      font-family: 'visa-font-semi-bold', sans-serif;
      text-decoration: none;
      color: var(--brand-primary-color);
      letter-spacing: .5px;
    }

    .nav-menu .nav-links li img {
      height: 28px;
      width: auto;
      margin-right: 1rem;
    }

    .nav-modal-body-cont {
      padding: 70px;
      position: relative;
      overflow: hidden auto;
      max-height: 100%;

      flex: 0 0 auto;
      width: 80%;
    }
    .nav-modal-body-cont .category-details .category-info {
      max-width: 70%;
    }

    .nav-modal-body-cont .category-details h6 {
      color: var(--brand-primary-color);
      font-size: 46px;
      font-family: 'visa-font-semi-bold', sans-serif;
    }

    .nav-modal-body-cont .category-details p {
      font-size: 1.4rem;
    }

    .nav-modal .close-btn {
      cursor: pointer;
      font-size: 40px;
      z-index: 2;
      line-height: .5;
      transition: transform 0.3s ease, background-color 0.3s ease;
      position: absolute;
      top: 30px;
      right: 30px;
    }

    .nav-modal .close-btn:hover {
      transform: scale(1.2);
    }

    .nav-modal .close-btn img {
      height: 30px;
      width: auto;
    }

    .cards-container {
      overflow-y: auto;
    }

    .wt-card {
      margin-bottom: 1rem;
      position: relative;
      display: block;
      max-width: 100%;
    }

    .img-container,
    .gs-img-container {
      position: relative;
      overflow: hidden;
      display: inline-block;
    }

    .overlay {
      position: absolute;
      top: -2px;
      right: -2px;
      bottom: -2px;
      left: -2px;
      background-color: rgba(20, 52, 203, 0.9);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all 0.3s ease-in-out;
      font-family: "visa-font", sans-serif;
      border-radius: 20px;
    }

    .img-container:hover .overlay,
    .gs-img-container:hover .overlay {
      opacity: 1;
    }

    .wt-card .overlay img {
      width: 24px !important;
    }

    .gs-card .overlay img {
      width: 24px !important;
    }

    .gs-card .overlay {
      font-size: 2rem;
    }

    .wt-card .overlay {
      font-size: 2rem;
    }

    .wt-card .img-container:hover,
    .gs-card .gs-img-container:hover {
      cursor: pointer;
    }

    .wt-card img {
      width: 100%;
      height: auto;
    }

    .getting-started .badge {
      margin: 1rem 1rem 0 0;
      padding: 12px 25px;
      border-radius: 5px !important;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 1px;

    }

    .card-body .badge {
      margin: 12px 9px 0 0;
      padding: 10px 20px;
      border-radius: 5px !important;
      text-transform: uppercase;
    }

    .badge.blue {
      background-color: #2b92f5 !important;
    }

    .badge.yellow {
      background-color: #f7a004 !important;
      color: #000;
    }

    .badge.red {
      background-color: #d55168 !important;
    }

    .badge.green {
      background-color: #3f9a6b !important;
    }

    .card-title {
      margin-top: 12px;
      color: var(--brand-primary-color);
      font-size: 22px;
      font-family: "visa-font-semi-bold", sans-serif;
      width: fit-content;
    }

    .card-title:hover {
      cursor: pointer;
      text-decoration: underline;
    }

    .cards .row {
      margin-top: 40px;
    }

    .getting-started {
      display: none;
      height: 100%;
    }

    .getting-started .row {
      margin: 0 !important;
    }

    .getting-started .col-6:first-of-type {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: flex-start;
      padding-left: 0 !important;
    }

    .getting-started .col-6:first-of-type p {
      padding-right: 2.5rem;
    }

    .getting-started .info .description {
      font-size: 1.5rem;
      margin-bottom: 2rem;
    }

    .getting-started .title {
      color: var(--brand-primary-color);
      font-size: 48px;
      line-height: 1.1;
      font-family: "visa-font-semi-bold", sans-serif;
    }

    .getting-started .gs-card {
      border-radius: 20px;
      background-color: var(--brand-tertiary-2-color);
      padding: 30px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      overflow: auto;
    }


    .getting-started .gs-card img {
      width: 100%;
      height: auto;
    }

    .getting-started .gs-card .title {
      color: var(--brand-primary-color);
      font-size: 28px;
      line-height: 1.2;
      font-family: "visa-bold", sans-serif;
      margin-top: 20px;
    }

    .getting-started .gs-card .title:hover {
      cursor: pointer;
      text-decoration: underline;
    }

    .getting-started .gs-card .description,
    .getting-started .gs-card a {
      font-size: 22px;
      font-family: "visa-font-semi-bold", sans-serif;
    }

    .getting-started .gs-card a {
      color: var(--brand-primary-color);
    }

    .getting-started .disclaimer {
      font-size: 10px;
      margin: 0 !important;
    }

    .btn-primary {
      background-color: var(--brand-primary-color) !important;
      border-color: var(--brand-primary-color) !important;
      font-family: "visa-font-semi-bold", sans-serif;
      display: flex;
      align-items: center;
      letter-spacing: .5px;
      font-size: 1.4rem;
      padding: 10px 25px
    }

    .btn-primary img {
      margin-left: 11px;
      height: 24px;
      width: auto;
    }

    .step-description .btn-primary {
      background-color: var(--brand-primary-color) !important;
      border-color: var(--brand-primary-color) !important;
      font-family: "visa-font-semi-bold", sans-serif;
      display: flex;
      align-items: center;
      letter-spacing: .5px;
      font-size: 1.2rem;
      padding: 10px 25px;
      line-height: 1;
    }

    .step-description .btn-primary:hover {
      background-color: var(--brand-primary-light-color) !important;
    }

    .step-description .btn-primary:active {
      background-color: var(--brand-primary-color) !important;
    }

    .step-description .btn-primary img {
      margin-left: 11px;
      height: 20px;
      width: auto;
    }
  </style>
</head>

<body>
  <cb-root></cb-root>



  <div class="walkthrough-container">

    <div class="vs-loading-wrapper" id="products-loader">
      <div class="vs-container">
        <div class="vs-row vs-justify-content-center">
          <p class="vs-text vs-align-center vs-bold">
            Please be patient while the tutorials load.
          </p>
        </div>
        <div class="vs-row vs-justify-content-center">
          <em class="vs-loading vs-align-center"></em>
        </div>
      </div>
    </div>

    <div class="blue-border graphic-container">
      <p>Open Menu and select a tutorial.</p>
    </div>

    <div class="details-container">
      <div class="details-header">
        <div class="visa-logo">
          <img src="assets/images/vsh-tour-logo.png">
          <!-- <p class="mt-1 mb-0 ml-3">Interactive Tutorial</p> -->
        </div>
        <!-- <div class="return-vol p-2">
          <p>Return to<br>Visa Online</p>
          <img src="assets/images/return-arrow.png">
        </div> -->
        <button id="openModalButton" class="hamburger btn">
          <img src="assets/images/hamburger.png">
        </button>
      </div>

      <div class="details-body blue-border">
        <div class="details-cont">
          <div class="wt-details">
            <p class="wt-category"></p>
            <p class="wt-title"></p>
          </div>
          <hr>
          <p class="step-description">
          </p>
        </div>

        <div class="details-footer">
          <button id="back-category" class="btn triple-carat">
            <img src="assets/images/triple-carat-left-icon.png" alt="previous category graphic">
          </button>

          <button id="back-tutorial" class="btn double-carat">
            <img src="assets/images/double-carat-left-icon.png" alt="previous tutorial graphic">
          </button>

          <button id="back-step" class="btn">
            <img src="assets/images/arrow-left.png" alt="Back 1 step graphic">
          </button>

          <p id="current-step-tracker" class="m-0"></p>

          <button id="forward-step" class="btn">
            <img src="assets/images/arrow-right.png" alt="Forward 1 step graphic">
          </button>

          <button id="next-tutorial" class="btn double-carat">
            <img src="assets/images/double-carat-right-icon.png" alt="next tutorial graphic">
          </button>

          <button id="next-category" class="btn triple-carat">
            <img src="assets/images/triple-carat-right-icon.png" alt="next category graphic">
          </button>
        </div>
      </div>
    </div>
  </div>


  <!-- Tutorial Selector / Nav Modal -->
  <div id="navModal" class="nav-modal-cont">
    <div class="vs-container-fluid h-100 nav-modal blue-border">
      <div class="row h-100">

        <!-- Left Nav / Categories -->
        <nav class=" h-100 nav-menu">
          <div class="nav-header">
            <img src="assets/images/vsh-tour-logo.png" alt="Visa Logo Image" />
          </div>

          <ul class="nav-links">
            <li>Lodaing...</li>
          </ul>
        </nav>

        <!-- Main Content -->
        <div class="nav-modal-body-cont">
          <span id="closeModalButton" class="close-btn">
            <img src="assets/images/close-icon.png">
          </span>

          <div id="cards-container">
            <div class="category-details d-flex justify-content-between align-items-center"></div>
            <div class="cards"></div>
          </div>


          <div class="getting-started">
            <div class="row h-100">
              <div class="col-6">
                <div class="info">
                  <p class="title">Get the most out of Visa Support Hub</p>
                  <p class="description">Start here for a complete a tour of Visa Support Hub or use the menu to jump to
                    a specific tutorial.</p>
                  <button id="begin-btn" class="btn btn-primary">Begin tour <img
                      src='assets/images/carat-right.png'></button>
                </div>
                <p class="disclaimer">Tutorial is for illustrative purposes only. Live view of Visa Support hub and the
                  tools within may not reflect this tutorial exactly</p>
              </div>
              <div class="col-6 gs-card">
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>

</body>
<script type="module">
  import { VSH_WALKTHROUGHS, CATEGORIES, TAGS } from './assets/walkthroughs_data.js';

  const delay = 500;

  class WTS {
    categories = [];
    CATEGORIES = CATEGORIES;
    TAGS = TAGS;

    constructor(walkthroughs) {
      this.walkthroughs = walkthroughs;
      this.getCategories();
      this.createNavModalUI();

      setTimeout(() => {
        const loader = document.getElementById("products-loader");
        loader.classList.remove("vs-d-block");
        loader.classList.add("vs-d-none");

      }, delay);


      // this.createNavModalUI();
    }

    createNavModalUI() {
      const ulElement = document.querySelector('.nav-links');
      const CATEGORIES = this.CATEGORIES;

      // const CATEGORIES = {
      //   GettingStarted: 'Getting Started',
      //   NewFeatures: 'New Features',
      //   Overview: 'Overview',
      //   HomePage: 'Home Page',
      //   Features: 'Features',
      //   FindInfo: 'Find Information',
      //   Announcements: 'Announcements and Visa Business News',
      //   Support: 'Support',
      //   TrainingAndEducation: 'Training & Education',
      // };

      // Remove any existing <li> elements first, to prevent duplicates
      ulElement.innerHTML = '';

      let firstLiElement = null;

      function setIconSrcForCategory(category, isActive = false) {
        let baseSrc = 'assets/images/visa_icons/';
        switch (category) {
          case CATEGORIES.GettingStarted:
            baseSrc += 'getting-started-icon';
            break;
          case CATEGORIES.NewFeatures:
            baseSrc += 'new-features-icon';
            break;
          case CATEGORIES.Overview:
            baseSrc += 'overview-icon';
            break;
          case CATEGORIES.AdministrationPanel:
            baseSrc += 'admin-settings-icon';
            break;
          case CATEGORIES.HomePage:
            baseSrc += 'home-page-icon';
            break;
          case CATEGORIES.Features:
            baseSrc += 'features-icon';
            break;
          case CATEGORIES.CaseDashboard:
            baseSrc += 'case-dashboard-icon';
            break;
          case CATEGORIES.FindInfo:
            baseSrc += 'find-info-icon';
            break;
          case CATEGORIES.Announcements:
            baseSrc += 'announcements-icon';
            break;
          case CATEGORIES.Support:
            baseSrc += 'support-icon';
            break;
          case CATEGORIES.TrainingAndEducation:
            baseSrc += 'training-icon';
            break;
          case CATEGORIES.SupportCases:
            baseSrc += 'support-cases-icon';
            break;
          case CATEGORIES.ProfileSettings:
            baseSrc += 'profile-settings-icon';
            break;
          default:
            // @TODO get actual default icon from Design
            baseSrc += 'new-features-icon';
            break;
        }
        return baseSrc + (isActive ? '-active.png' : '.png');
      }

      this.categories.forEach((category, index) => {
        const liElement = document.createElement('li');
        const aElement = document.createElement('a');
        const iconElement = document.createElement('img');

        iconElement.src = setIconSrcForCategory(category);

        aElement.setAttribute('role', 'button');
        aElement.textContent = category;

        liElement.appendChild(iconElement);
        liElement.appendChild(aElement);
        ulElement.appendChild(liElement);

        // Save a reference to the first <li> element
        if (index === 0) {
          firstLiElement = liElement;
        }

        liElement.addEventListener('click', () => {
          // Remove 'active' class from all li elements
          ulElement.querySelectorAll('li').forEach(li => li.classList.remove('active'));

          // Add 'active' class to clicked li element
          liElement.classList.add('active');

          // Update the icon for each list item based on its active status
          ulElement.querySelectorAll('li').forEach(li => {
            const iconImg = li.querySelector('img');
            const currentCategory = li.querySelector('a').textContent;
            iconImg.src = setIconSrcForCategory(currentCategory, li.classList.contains('active'));
          });

          this.showWalkThroughsFor(category);
        });
      });

      // Programmatically "click" the first <li> element to make it active
      if (firstLiElement) {
        firstLiElement.click();
      }


    }

    showWalkThroughsFor(category) {
      // console.log({ category });

      const currentWalkThroughs = this.walkthroughs.filter(wt => wt.category === category);
      // console.log({ currentWalkThroughs });

      if (category === 'Getting Started') {
        this.renderGettingStarted(currentWalkThroughs[0]);
      } else {
        const { categoryDescription } = currentWalkThroughs[0];

        this.renderCategoryDetails(category, categoryDescription, currentWalkThroughs[0]);
        this.renderCardsContainer(currentWalkThroughs);
      }
    }

    renderGettingStarted(walkthrough) {
      const cardsContainer = document.querySelector('#cards-container');
      cardsContainer.style.display = 'none';

      console.log({ walkthrough });

      // Clear contents
      document.querySelector('.category-details').innerHTML = '';
      document.querySelector('.cards').innerHTML = '';
      document.querySelector('.getting-started').style.display = 'block';

      const gettingStartedContainer = document.querySelector('.gs-card');
      gettingStartedContainer.innerHTML = '';

      const cardContainer = document.createElement('div');

      const gsImgContainer = document.createElement('div');
      gsImgContainer.classList.add('gs-img-container', 'blue-border');
      gsImgContainer.addEventListener('click', () => {
        this.startWalkthrough(walkthrough);
      });
      cardContainer.appendChild(gsImgContainer);

      // Insert thumbnail image into cardContainer
      const thumbnail = document.createElement('img');
      thumbnail.src = walkthrough.thumbnailPath;
      thumbnail.alt = walkthrough.title;
      gsImgContainer.appendChild(thumbnail);

      const overlay = document.createElement('div');
      overlay.classList.add('overlay');
      overlay.textContent = 'Open tutorial';
      gsImgContainer.appendChild(overlay);

      const arrowImg = document.createElement('img');
      arrowImg.src = 'assets/images/arrow-open.png';
      arrowImg.alt = 'Open';
      arrowImg.style.marginLeft = '1rem'; // to give some space between the text and the image
      overlay.appendChild(arrowImg);

      // Insert tags as badges
      const tagsContainer = document.createElement('div');
      walkthrough.tags.forEach(tag => {
        const badge = document.createElement('span');
        badge.classList.add('badge', 'bg-primary', this.getBadgeClass(tag));
        badge.textContent = tag;
        tagsContainer.appendChild(badge);
      });
      cardContainer.appendChild(tagsContainer);

      // Insert title
      const title = document.createElement('h5');
      title.classList.add('title');
      title.textContent = walkthrough.title;
      title.addEventListener('click', () => {
        this.startWalkthrough(walkthrough);
      });
      cardContainer.appendChild(title);

      // Insert description
      const description = document.createElement('p');
      description.classList.add('description');
      description.textContent = walkthrough.categoryDescription;
      cardContainer.appendChild(description);

      // Add click func to Begin Tour button
      const startButton = document.getElementById('begin-btn');
      startButton.addEventListener('click', () => {
        this.startWalkthrough(walkthrough);
      });

      gettingStartedContainer.appendChild(cardContainer);

      // Insert anchor link
      const anchor = document.createElement('a');
      anchor.href = '#';
      anchor.textContent = 'Start tutorial >';
      anchor.addEventListener('click', (e) => {
        e.preventDefault();
        this.startWalkthrough(walkthrough);
      });
      gettingStartedContainer.appendChild(anchor);
    }

    getBadgeClass(tag) {
      switch (tag.toLowerCase()) {
        case 'featured': return 'blue';
        case 'new': return 'yellow';
        case 'popular': return 'red';
        case 'most requested': return 'green';
        default: return 'blue';
      }
    }

    renderCategoryDetails(category, categoryDescription, firstWalkthrough) {
      const gsContainer = document.querySelector('.getting-started')
      gsContainer.style.display = 'none';

      const categoryDetailsContainer = document.querySelector('.category-details');
      categoryDetailsContainer.innerHTML = '';

      const textContainer = document.createElement('div');
      textContainer.classList.add('category-info');
      categoryDetailsContainer.appendChild(textContainer);

      const categoryHeading = document.createElement('h6');
      categoryHeading.textContent = category;
      textContainer.appendChild(categoryHeading);

      const categoryDescParagraph = document.createElement('p');
      categoryDescParagraph.textContent = categoryDescription;
      categoryDescParagraph.style.marginBottom = 0;
      textContainer.appendChild(categoryDescParagraph);

      const startTutorialBtn = document.createElement('button');
      startTutorialBtn.innerHTML = `Start tutorials  <img src='assets/images/carat-right.png'>`;
      startTutorialBtn.classList.add('btn', 'btn-primary');
      startTutorialBtn.addEventListener('click', () => {
        this.startWalkthrough(firstWalkthrough);
      });
      categoryDetailsContainer.appendChild(startTutorialBtn);
    }

    renderCard(walkthrough) {
      const col = document.createElement('div');
      col.classList.add('col-4');

      const card = document.createElement('div');
      card.classList.add('wt-card');
      col.appendChild(card)

      const imgContainer = document.createElement('div');
      imgContainer.classList.add('img-container', 'blue-border');
      imgContainer.addEventListener('click', () => {
        this.startWalkthrough(walkthrough);
      });
      card.appendChild(imgContainer);

      const thumbnail = document.createElement('img');
      thumbnail.src = walkthrough.thumbnailPath;
      thumbnail.alt = walkthrough.title;
      imgContainer.appendChild(thumbnail);

      const overlay = document.createElement('div');
      overlay.classList.add('overlay');
      overlay.textContent = 'Open tutorial';
      imgContainer.appendChild(overlay);

      const arrowImg = document.createElement('img');
      arrowImg.src = 'assets/images/arrow-open.png';
      arrowImg.alt = 'Open';
      arrowImg.style.marginLeft = '10px'; // to give some space between the text and the image
      overlay.appendChild(arrowImg);

      const cardBody = document.createElement('div');
      cardBody.classList.add('card-body');
      card.appendChild(cardBody);

      const tagsContainer = document.createElement('div');
      walkthrough.tags.forEach(tag => {
        const badge = document.createElement('span');
        badge.classList.add('badge', 'bg-primary'); // default class for the badge

        // Assign color class to badge depending on tag text
        switch (tag) {
          case this.TAGS.featured:
            badge.classList.add('blue');
            break;
          case this.TAGS.new:
            badge.classList.add('yellow');
            break;
          case this.TAGS.popular:
            badge.classList.add('red');
            break;
          case this.TAGS.requested:
            badge.classList.add('green');
            break;
          default:
            // handle any other tags if necessary or keep as default
            badge.classList.add('blue');
            break;
        }
        badge.textContent = tag;
        tagsContainer.appendChild(badge);
      });
      cardBody.appendChild(tagsContainer);

      const title = document.createElement('h5');
      title.classList.add('card-title');
      title.textContent = walkthrough.title;
      title.addEventListener('click', () => {
        this.startWalkthrough(walkthrough);
      });
      cardBody.appendChild(title);

      return col;
    }

    renderCardsContainer(currentWalkThroughs) {
      const container = document.querySelector('#cards-container');
      container.style.display = 'block';

      const cardsContainer = document.querySelector('.cards');
      cardsContainer.innerHTML = '';

      let row;

      currentWalkThroughs.forEach((walkthrough, index) => {
        if (index % 3 === 0) {
          row = document.createElement('div');
          row.classList.add('row');
          cardsContainer.appendChild(row);
        }
        const card = this.renderCard(walkthrough);
        row.appendChild(card);
      });
    }

    startWalkthrough(walkthrough, displaylastStep = false) {
      const walkthroughs = this.walkthroughs;
      let currentStepIndex = 0;

      // DOM Elements caching
      const navModal = document.querySelector('#navModal');
      const closeModalButton = document.querySelector('#closeModalButton');
      const categoryElement = document.querySelector('.wt-category');
      const titleElement = document.querySelector('.wt-title');
      const descriptionElement = document.querySelector('.step-description');
      const backStepButton = document.querySelector('#back-step');
      const forwardStepButton = document.querySelector('#forward-step');
      const backTutorialButton = document.querySelector('#back-tutorial');
      const nextTutorialButton = document.querySelector('#next-tutorial');
      const previousCategoryButton = document.querySelector('#back-category');
      const nextCategoryButton = document.querySelector('#next-category');
      const graphicContainer = document.querySelector('.graphic-container');
      const stepTracker = document.querySelector('#current-step-tracker');

      // Helper Functions
      const displayNote = (noteContent) => {
        const noteElement = document.createElement('p');
        noteElement.classList.add('note');
        noteElement.innerHTML = `<b>NOTE:</b> ${noteContent}`;
        descriptionElement.appendChild(noteElement);
      };

      const displayStep = (stepIndex) => {
        if (!walkthrough.steps[stepIndex]) {
          console.error("Invalid step index");
          return;
        }
        descriptionElement.innerHTML = '';

        const step = walkthrough.steps[stepIndex];


        if (step.description) {
          const descriptionTextElement = document.createElement('p')
          descriptionTextElement.innerHTML = step.description;
          descriptionElement.appendChild(descriptionTextElement);
        }

        // descriptionElement.innerHTML = step.description;

        step.note && displayNote(step.note);

        if (stepIndex === 0) {
          appendStartButton();
        } else if (stepIndex === walkthrough.steps.length - 1) {
          appendNextOrMenuButton();
        }

        updateImage(step.imagePath, stepIndex);
        stepTracker.textContent = `${stepIndex + 1} / ${walkthrough.steps.length}`;
      };

      const updateButtonsState = () => {
        const currentWalkThroughs = walkthroughs.filter(wt => wt.category === walkthrough.category);


        if (currentStepIndex === 0) {
          backStepButton.style.display = 'none';
          forwardStepButton.style.display = 'block';
          nextTutorialButton.style.display = 'none';
          nextTutorialButton.style.visibility = 'initial';
          nextCategoryButton.style.display = 'none';

          if (walkthrough.title != currentWalkThroughs[0].title) {
            // display back tutrial button
            backTutorialButton.style.display = 'block';
            //add click func
            backTutorialButton.addEventListener('click', () => {
              const currentWTIndex = currentWalkThroughs.findIndex(wt => wt.title === walkthrough.title);
              this.startWalkthrough(currentWalkThroughs[currentWTIndex - 1], true);
            });
            previousCategoryButton.style.display = 'none';
          } else {
            // hide back tutrial button
            backTutorialButton.style.display = 'none';

            if (walkthrough.category != this.categories[0]) {
              previousCategoryButton.style.display = 'block';
              previousCategoryButton.addEventListener('click', () => {
                // go to previous category's last tutorials last step
                const prevCategoryIndex = this.categories.findIndex(cat => cat == walkthrough.category) - 1;
                const prevCategoryWalkThoughs = walkthroughs.filter(wt => wt.category === this.categories[prevCategoryIndex]);
                this.startWalkthrough(prevCategoryWalkThoughs[prevCategoryWalkThoughs.length - 1], true);
              })
            } else previousCategoryButton.style.display = 'none';
          }

        } else if (currentStepIndex === walkthrough.steps.length - 1) {
          backStepButton.style.display = 'block';
          forwardStepButton.style.display = 'none';
          backTutorialButton.style.display = 'none';
          previousCategoryButton.style.display = 'none';

          if (walkthrough.title === currentWalkThroughs[currentWalkThroughs.length - 1].title) {
            nextTutorialButton.style.visibility = 'hidden';
            nextTutorialButton.style.display = 'block';
            nextTutorialButton.addEventListener('click', () => {
              // do nothing, that was last tutorial in category
            });

            // if not in last category
            if (walkthrough.category != this.categories[this.categories.length - 1]) {
              // go to first tutorial in next category
              nextCategoryButton.style.display = 'block';
              nextCategoryButton.addEventListener('click', () => {
                const nextCategoryIndex = this.categories.findIndex(cat => cat === walkthrough.category) + 1;
                const nextCategoryWalkthroughs = walkthroughs.filter(wt => wt.category === this.categories[nextCategoryIndex]);
                this.startWalkthrough(nextCategoryWalkthroughs[0]);
              });
              nextTutorialButton.style.display = 'none';
            } else nextCategoryButton.style.display = 'none';

          } else {
            nextTutorialButton.style.visibility = 'initial';
            nextTutorialButton.style.display = 'block'
            nextTutorialButton.addEventListener('click', () => {
              const currentWTIndex = currentWalkThroughs.findIndex(wt => wt.title === walkthrough.title);
              this.startWalkthrough(currentWalkThroughs[currentWTIndex + 1]);
            })
          }
        } else {
          backStepButton.style.display = 'block';
          forwardStepButton.style.display = 'block';
          nextTutorialButton.style.display = 'none';
          nextTutorialButton.style.visibility = 'initial';
          backTutorialButton.style.display = 'none';
          previousCategoryButton.style.display = 'none';
          nextCategoryButton.style.display = 'none';
        }
      };

      const updateImage = (imagePath, stepIndex) => {
        graphicContainer.innerHTML = '';  // Clear previous image

        const image = document.createElement('img');
        image.src = imagePath;
        image.alt = `Step ${stepIndex + 1} Image`;
        graphicContainer.appendChild(image);
      };

      const appendStartButton = () => {
        const startBtnElement = document.createElement('btn');
        startBtnElement.classList.add('btn', 'btn-primary', 'start-btn');
        startBtnElement.innerHTML = `Start Tutorial <img src='assets/images/carat-right.png'>`;
        startBtnElement.addEventListener('click', () => {
          currentStepIndex++;
          displayStep(currentStepIndex);
          updateButtonsState();
        });
        descriptionElement.appendChild(startBtnElement);
      };

      const appendNextOrMenuButton = () => {
        const currentWalkThroughs = walkthroughs.filter(wt => wt.category === walkthrough.category);
        const nextBtnElement = document.createElement('btn');
        nextBtnElement.classList.add('btn', 'btn-primary', 'next-btn');

        if (walkthrough.title === currentWalkThroughs[currentWalkThroughs.length - 1].title) {
          nextBtnElement.innerHTML = `Back to Menu <img src='assets/images/carat-right.png'>`;
          nextBtnElement.addEventListener('click', () => navModal.style.display = 'block');
        } else {
          nextBtnElement.innerHTML = `Next Tutorial <img src='assets/images/carat-right.png'>`;
          nextBtnElement.addEventListener('click', () => {
            const currentWTIndex = currentWalkThroughs.findIndex(wt => wt.title === walkthrough.title);
            this.startWalkthrough(currentWalkThroughs[currentWTIndex + 1]);
          });
        }

        descriptionElement.appendChild(nextBtnElement);
      };

      // Initialize the walkthrough
      navModal.style.display = "none";
      closeModalButton.style.display = 'block';
      categoryElement.textContent = walkthrough.category;
      titleElement.textContent = walkthrough.title;

      if (displaylastStep) currentStepIndex = walkthrough.steps.length - 1;
      displayStep(currentStepIndex);

      backStepButton.addEventListener('click', () => {
        if (currentStepIndex > 0) {
          currentStepIndex--;
          displayStep(currentStepIndex);
          updateButtonsState();
        }
      });

      forwardStepButton.addEventListener('click', () => {
        if (currentStepIndex < walkthrough.steps.length - 1) {
          currentStepIndex++;
          displayStep(currentStepIndex);
          updateButtonsState();
        }
      });

      updateButtonsState();
    }

    getCategories() {
      this.categories = Array.from(new Set(this.walkthroughs.map(wt => wt.category)));
    }
  }


  // Load appropriate Walkthroughs (VOL/VSH) and create instance
  const wts = new WTS(VSH_WALKTHROUGHS);

  window.addEventListener('load', function () {
    // Grab Nav Modal Elements
    const openModalButton = document.getElementById("openModalButton");
    const closeModalButton = document.getElementById("closeModalButton");
    const navModal = document.getElementById("navModal");

    // Show the modal shortly after the page loads
    setTimeout(() => {
      closeModalButton.style.display = 'none';
      navModal.style.display = "block";
    }, delay);

    // Open modal on button click
    openModalButton.addEventListener("click", function () {
      navModal.style.display = "block";
    });

    // Close modal on button click
    closeModalButton.addEventListener("click", function () {
      navModal.style.display = "none";
    });
  });

</script>

</html>